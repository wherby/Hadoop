"use strict";define("bundles/programming/components/SubmissionInfo",["require","exports","module","react-with-addons","bundles/phoenix/components/Time","i18n!nls/programming","bundles/programming/components/SubmissionPartTable","bundles/programming/models/immediate/assignmentParts","bundles/programming/models/submissionSummary","bundles/ondemand/stores/ProgressStore","bundles/ondemand/stores/SessionStore","bundles/ondemand/appContextSingleton","css!bundles/programming/components/__styles__/SubmissionInfo.css"],function(require,exports,module){var e=require("react-with-addons"),s=require("bundles/phoenix/components/Time"),n=require("i18n!nls/programming"),t=require("bundles/programming/components/SubmissionPartTable"),r=require("bundles/programming/models/immediate/assignmentParts"),a=require("bundles/programming/models/submissionSummary"),i=require("bundles/ondemand/stores/ProgressStore"),o=require("bundles/ondemand/stores/SessionStore"),l=require("bundles/ondemand/appContextSingleton");require("css!bundles/programming/components/__styles__/SubmissionInfo.css");var m=e.createClass({displayName:"SubmissionInfo",propTypes:{submission:e.PropTypes.instanceOf(a).isRequired,assignmentParts:e.PropTypes.instanceOf(r).isRequired,moduleId:e.PropTypes.string.isRequired,title:e.PropTypes.string},getDefaultProps:function getDefaultProps(){return{title:n("Submission")}},getInitialState:function getInitialState(){return{isExpanded:this.props.isExpanded||!1}},handleExpanderClick:function handleExpanderClick(e){e.preventDefault(),e.target.blur(),this.setState({isExpanded:!this.state.isExpanded})},renderGrade:function renderGrade(){var s=this.props.submission;if(o.isEnrolled()&&s.get("evaluation").isPassed()){var m=s.get("evaluation"),d=s.get("submittedAt"),t=m.getPercentScore(),c=l.getComponentContext().getStore("CourseScheduleStore"),p=c.getDeadlineForModuleId(this.props.moduleId),r=i.getPenalizedScore(p,d,t),a=r.penaltyPercent,u=r.penalizedScoreInPercent;if(a>0)return e.createElement("div",{className:"c-grade-card"},e.createElement("div",null,e.createElement("strong",null,n("Grade"))),e.createElement("h3",{className:"heading"},e.createElement("span",null,t," - ",a," = "),e.createElement("span",null,u,"%")),e.createElement("div",{className:"color-hint-text caption"},n("Late penalty applied")))}},render:function render(){var r=this.props.submission,o=this.props.assignmentParts,i=this.state.isExpanded,a=r.get("evaluation"),l=function partTable(){return e.createElement(t,{assignmentParts:o,evaluations:r.get("partEvaluations")})};return e.createElement("div",{href:"#",className:"rc-SubmissionInfo well",onClick:this.handleExpanderClick},e.createElement("a",{href:"#",className:"pull-right",onClick:this.handleExpanderClick},n(i?"less":"more")),e.createElement("h6",null,this.props.title),e.createElement("div",{className:"c-score-card"},e.createElement("div",null,e.createElement("strong",null,n("Score"))),e.createElement("h3",{className:"heading headline-3-text"},a.get("score")," / ",a.get("maxScore")," ",n("points earned"),a.isPassed()&&e.createElement("div",{className:"pill-success pass-pill"},n("PASSED"))),e.createElement("div",{className:"color-hint-text caption"},n("Submitted on")," ",e.createElement(s,{time:r.get("submittedAt")}))),this.renderGrade(),i&&l())}});module.exports=m});